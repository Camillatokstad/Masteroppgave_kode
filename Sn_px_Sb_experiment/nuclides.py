import numpy as np 
import matplotlib.pyplot as plt

N_A = 6.02214076e23  # 1/mol
M = {"Cu": 63.546, "Ni": 58.6934, "Sn": 118.71, "Ta": 180.9479}  # g/mol

data = {
    "Cu": (np.array([21.906,22.235,22.253,22.289,22.311,22.233,22.258,22.197,22.091,22.259,22.211,22.177,22.168,22.125]),
           np.array([0.086,0.041,0.067,0.029,0.022,0.057,0.037,0.023,0.039,0.032,0.105,0.062,0.058,0.112])),
    "Ni": (np.array([23.079,23.091,22.966,22.982,22.942,22.631,22.529,23.145,22.662,23.107,22.941,23.155,23.153,23.067]),
           np.array([0.034,0.016,0.071,0.048,0.028,0.038,0.032,0.096,0.015,0.024,0.030,0.016,0.038,0.026])),
    "Sn": (np.array([37.475,37.211,37.130,36.990,8.004,7.816,7.917,8.047,7.829,8.232,7.982,8.021,7.354,7.620]),
           np.array([0.436,0.166,0.141,0.298,0.019,0.026,0.017,0.018,0.010,0.012,0.019,0.023,0.026,0.013])),
    "Ta": (np.array([27.334,27.396,27.702,27.518,27.197,27.374,27.539,27.227,27.337,27.165,27.200,27.702,27.337,27.361]),
           np.array([0.090,0.138,0.080,0.066,0.141,0.157,0.073,0.129,0.074,0.151,0.136,0.136,0.041,0.104]))}

for el, (ad, ad_u) in data.items():
    k = 1e-3 * N_A / M[el]   # mg/cm^2 -> nuclei/cm^2
    N, N_u = k * ad, k * ad_u

    print(f"\n{el}:")
    for i, (x, xu, n, nu) in enumerate(zip(ad, ad_u, N, N_u), 1):
        print(f"{i:d}: {x:6.3f} ± {xu:5.3f}  ->  {n:.4e} ± {nu:.4e} nuclei/cm^2")
